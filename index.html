<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>DUWELL Studio - í•˜ì´ì—”ë“œ í†µí•© ì™„ê²°íŒ</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.1/fabric.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Nanum+Myeongjo:wght@700&family=Noto+Sans+KR:wght@400;700&family=Black+Han+Sans&family=Do+Hyeon&family=Song+Myung&family=Nanum+Pen+Script&family=Gamja+Flower&family=East+Sea+Dokdo&family=Hi+Melody&family=Sunflower:wght@500&family=Gothic+A1:wght@700&family=Poor+Story&family=Gaegu&family=Yeon+Sung&family=Playfair+Display:wght@700&family=Montserrat:wght@700&family=Pacifico&family=Cinzel:wght@700&family=Dancing+Script&family=Bebas+Neue&family=Orbitron:wght@700&display=swap" rel="stylesheet">
    <style>
        :root { --duwell-wine: #800020; }
        body { font-family: 'Noto Sans KR', sans-serif; background: #f0f2f5; margin: 0; display: flex; height: 100vh; overflow: hidden; }
        
        @media (max-width: 900px) {
            body { flex-direction: column; overflow-y: auto; }
            .sidebar { width: 100% !important; height: auto !important; border-right: none !important; padding: 15px !important; }
            .workspace { flex: none !important; height: 350px !important; padding: 10px !important; }
            .canvas-container { transform: scale(0.45); transform-origin: center; }
        }

        .sidebar { width: 420px; background: white; box-shadow: 4px 0 20px rgba(0,0,0,0.1); padding: 25px; z-index: 10; overflow-y: auto; display: flex; flex-direction: column; gap: 20px; }
        .logo { color: var(--duwell-wine); font-size: 26px; font-weight: 900; text-align: center; border-bottom: 2px solid var(--duwell-wine); padding-bottom: 10px; margin: 0; }
        
        .group { padding-bottom: 15px; border-bottom: 1px solid #eee; }
        label { display: block; font-weight: 700; margin-bottom: 10px; font-size: 13px; color: #333; }
        
        .item-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 6px; max-height: 180px; overflow-y: auto; padding: 8px; background: #f9f9f9; border-radius: 8px; }
        .item-btn { padding: 10px 5px; border: 1px solid #ddd; background: white; cursor: pointer; font-size: 11px; border-radius: 4px; text-align: center; transition: 0.2s; }
        .item-btn:hover { border-color: var(--duwell-wine); background: #fffafb; color: var(--duwell-wine); font-weight: bold; }

        .color-grid { display: grid; grid-template-columns: repeat(8, 1fr); gap: 4px; }
        .dot { width: 100%; aspect-ratio: 1; border-radius: 4px; border: 1px solid #ddd; cursor: pointer; }

        .control-panel { display: flex; align-items: center; gap: 10px; margin-top: 10px; background: #fdfdfd; padding: 10px; border-radius: 6px; border: 1px solid #eee; }
        .size-display { font-weight: bold; color: var(--duwell-wine); min-width: 55px; text-align: center; border: 1px solid var(--duwell-wine); border-radius: 4px; padding: 3px; font-size: 12px; }
        
        .workspace { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; background: #dfe4ea; padding: 20px; position: relative; }
        .canvas-container { box-shadow: 0 15px 50px rgba(0,0,0,0.2); background: white !important; border: 2px solid var(--duwell-wine); }
        
        .upload-area { background: #fffafb; border: 2px dashed var(--duwell-wine); padding: 15px; border-radius: 8px; text-align: center; cursor: pointer; }
        .action-btn { width: 100%; padding: 15px; border-radius: 8px; font-weight: bold; cursor: pointer; border: none; font-size: 15px; margin-top: 5px; }
        .btn-print { background: var(--duwell-wine); color: white; }
        .btn-send { background: #1a1a1a; color: white; }
        
        input[type="range"] { accent-color: var(--duwell-wine); flex: 1; }
    </style>
</head>
<body>

<div class="sidebar">
    <h1 class="logo">DUWELL STUDIO</h1>
    
    <div class="group">
        <label>ğŸ“¸ ë‚´ ì´ë¯¸ì§€/ë¡œê³  ì¶”ê°€</label>
        <div class="upload-area" onclick="document.getElementById('upload').click()">
            <span style="font-size: 20px;">ğŸ“</span> íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸°
            <input type="file" id="upload" accept="image/*" style="display:none">
        </div>
    </div>

    <div class="group">
        <label>ğŸ¨ ë°°ê²½ ì»¬ëŸ¬ ì„ íƒ</label>
        <div class="color-grid">
            <div class="dot" style="background: #ffffff;" onclick="setBG('#ffffff')"></div>
            <div class="dot" style="background: #800020;" onclick="setBG('#800020')"></div>
            <div class="dot" style="background: #000000;" onclick="setBG('#000000')"></div>
            <div class="dot" style="background: #f5f5dc;" onclick="setBG('#f5f5dc')"></div>
            <div class="dot" style="background: #dcdde1;" onclick="setBG('#dcdde1')"></div>
            <div class="dot" style="background: #fab1a0;" onclick="setBG('#fab1a0')"></div>
            <div class="dot" style="background: #74b9ff;" onclick="setBG('#74b9ff')"></div>
            <div class="dot" style="background: #55efc4;" onclick="setBG('#55efc4')"></div>
        </div>
    </div>

    <div class="group">
        <label>ğŸ”¤ í°íŠ¸ ì„ íƒ & ì •ë°€ ì„¤ì •</label>
        <div class="item-grid">
            <button class="item-btn" style="font-family:'Noto Sans KR'" onclick="addText('Noto Sans KR', 'ê¸°ë³¸ ê³ ë”•')">ê¸°ë³¸ ê³ ë”•</button>
            <button class="item-btn" style="font-family:'Nanum Myeongjo'" onclick="addText('Nanum Myeongjo', 'ë‚˜ëˆ” ëª…ì¡°')">ë‚˜ëˆ” ëª…ì¡°</button>
            <button class="item-btn" style="font-family:'Black Han Sans'" onclick="addText('Black Han Sans', 'ê²€ì€ ê³ ë”•')">ê²€ì€ ê³ ë”•</button>
            <button class="item-btn" style="font-family:'Do Hyeon'" onclick="addText('Do Hyeon', 'ë„í˜„ì²´')">ë„í˜„ì²´</button>
            <button class="item-btn" style="font-family:'Nanum Pen Script'" onclick="addText('Nanum Pen Script', 'ì†ê¸€ì”¨')">ë‚˜ëˆ” íœ</button>
            <button class="item-btn" style="font-family:'East Sea Dokdo'" onclick="addText('East Sea Dokdo', 'ë…ë„ì²´')">ë…ë„ì²´</button>
            <button class="item-btn" style="font-family:'Playfair Display'" onclick="addText('Playfair Display', 'Luxury')">Luxury</button>
            <button class="item-btn" style="font-family:'Pacifico'" onclick="addText('Pacifico', 'Style')">Style</button>
        </div>
        
        <div class="control-panel">
            <input type="range" id="sizeRange" min="10" max="150" value="35" oninput="updateFontSize(this.value)">
            <div id="sizeNum" class="size-display">35px</div>
        </div>
        
        <div class="control-panel">
            <label style="margin:0; flex:1; font-size:12px;">ê¸€ì ìƒ‰ìƒ ë³€ê²½:</label>
            <input type="color" id="textColorPicker" value="#333333" oninput="changeTextColor(this.value)" style="width:50px; height:30px; cursor:pointer;">
        </div>
    </div>

    <div class="group">
        <label>ğŸ ì¶”ì²œ ë¬¸êµ¬ & ì´ëª¨í‹°ì½˜</label>
        <div class="item-grid" style="grid-template-columns: repeat(3, 1fr);">
            <button class="item-btn" onclick="addText('Nanum Myeongjo', 'ì²«ëŒ ì¶•í•˜')">ğŸ¼ ëŒì”ì¹˜</button>
            <button class="item-btn" onclick="addEmoji('â™¥')">â™¥ í•˜íŠ¸</button>
            <button class="item-btn" onclick="addEmoji('ğŸ‘‘')">ğŸ‘‘ ì™•ê´€</button>
            <button class="item-btn" onclick="addEmoji('ğŸŒ¸')">ğŸŒ¸ ë²šê½ƒ</button>
            <button class="item-btn" onclick="addEmoji('â˜…')">â˜… ë³„</button>
            <button class="item-btn" onclick="addEmoji('ğŸŒ¿')">ğŸŒ¿ ë‚˜ë­‡ì</button>
        </div>
    </div>

    <div class="group" style="border:none;">
        <label>âš™ï¸ í¸ì§‘ (Deleteí‚¤ ì‚¬ìš©ê°€ëŠ¥)</label>
        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 5px;">
            <button class="item-btn" onclick="changeLayer('front')">ì•ìœ¼ë¡œ</button>
            <button class="item-btn" onclick="changeLayer('back')">ë’¤ë¡œ</button>
            <button class="item-btn" style="color:red; font-weight:bold;" onclick="deleteObj()">ì‚­ì œ</button>
        </div>
    </div>

    <div style="margin-top: auto;">
        <button class="action-btn btn-print" onclick="exportPrint()">âœ… 39x4.5cm ì¸ì‡„ íŒŒì¼ ë‹¤ìš´ë¡œë“œ</button>
        <button class="action-btn btn-send" onclick="sendEmail()">ğŸ“§ duwell@gmail.com ì „ì†¡</button>
    </div>
</div>

<div class="workspace">
    <div id="canvas-wrapper"><canvas id="mainCanvas"></canvas></div>
    <p style="margin-top: 15px; color: var(--duwell-wine); font-weight: bold; font-size: 14px;">ì¸ì‡„ ê°€ì´ë“œ ì˜ì—­: 39cm x 4.5cm</p>
    <div style="position: absolute; bottom: 20px; font-size: 11px; color: #888;">ğŸ’¡ PCì—ì„œëŠ” <b>Delete</b> í‚¤ë¡œ ìš”ì†Œë¥¼ ë°”ë¡œ ì§€ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div>
</div>

<script>
    const canvas = new fabric.Canvas('mainCanvas', { 
        width: 866, 
        height: 100, 
        backgroundColor: '#ffffff',
        preserveObjectStacking: true
    });

    let guide;
    function initGuide() {
        guide = new fabric.Rect({ left: 5, top: 5, width: 856, height: 90, fill: 'transparent', stroke: '#800020', strokeDashArray: [4, 4], selectable: false, evented: false, opacity: 0.3 });
        canvas.add(guide);
        canvas.sendToBack(guide);
    }
    initGuide();

    window.addEventListener('keydown', (e) => {
        const activeObj = canvas.getActiveObject();
        if (activeObj && !activeObj.isEditing && (e.key === 'Delete' || e.key === 'Backspace')) {
            deleteObj();
        }
    });

    function setBG(color) { canvas.setBackgroundColor(color, canvas.renderAll.bind(canvas)); }

    function addText(font, textStr) {
        const color = document.getElementById('textColorPicker').value;
        const text = new fabric.IText(textStr, { 
            left: 150, top: 25, fontFamily: font, fontSize: 35, fill: color 
        });
        canvas.add(text);
        canvas.setActiveObject(text);
        syncUI(text);
    }

    function addEmoji(emoji) {
        const text = new fabric.IText(emoji, { left: 100, top: 15, fontSize: 45 });
        canvas.add(text);
        canvas.setActiveObject(text);
    }

    function changeTextColor(color) {
        const obj = canvas.getActiveObject();
        if (obj && obj.type === 'i-text') {
            obj.set('fill', color);
            canvas.renderAll();
        }
    }

    function updateFontSize(val) {
        document.getElementById('sizeNum').innerText = val + 'px';
        const obj = canvas.getActiveObject();
        if (obj && obj.type === 'i-text') {
            obj.set('fontSize', parseInt(val));
            canvas.renderAll();
        }
    }

    canvas.on('selection:created', (e) => syncUI(e.selected[0]));
    canvas.on('selection:updated', (e) => syncUI(e.selected[0]));
    function syncUI(obj) {
        if (obj && obj.type === 'i-text') {
            document.getElementById('sizeRange').value = Math.round(obj.fontSize);
            document.getElementById('sizeNum').innerText = Math.round(obj.fontSize) + 'px';
            document.getElementById('textColorPicker').value = obj.fill;
        }
    }

    function changeLayer(dir) {
        const obj = canvas.getActiveObject();
        if(!obj) return;
        dir === 'front' ? obj.bringToFront() : obj.sendToBack();
        canvas.sendToBack(guide);
        canvas.renderAll();
    }

    function deleteObj() {
        const activeObjects = canvas.getActiveObjects();
        if (activeObjects.length) {
            canvas.discardActiveObject();
            activeObjects.forEach(obj => canvas.remove(obj));
            canvas.renderAll();
        }
    }

    document.getElementById('upload').onchange = (e) => {
        const reader = new FileReader();
        reader.onload = (f) => {
            fabric.Image.fromURL(f.target.result, (img) => {
                img.scaleToHeight(80);
                canvas.add(img).setActiveObject(img);
            });
        };
        reader.readAsDataURL(e.target.files[0]);
    };

    function exportPrint() {
        guide.visible = false;
        canvas.renderAll();
        const link = document.createElement('a');
        link.href = canvas.toDataURL({ format: 'png', multiplier: 6 });
        link.download = `DUWELL_PRINT_${Date.now()}.png`;
        link.click();
        guide.visible = true;
        canvas.renderAll();
    }

    function sendEmail() {
        window.location.href = `mailto:duwell@gmail.com?subject=[ì‹œì•ˆì „ì†¡] ìˆ˜ê±´ ì£¼ë¬¸ ì˜ë¢°&body=ì‘ì—…í•˜ì‹  ì‹œì•ˆ íŒŒì¼ì„ ì²¨ë¶€í•´ì£¼ì„¸ìš”!`;
        alert("ë©”ì¼ ì•±ìœ¼ë¡œ ì—°ê²°ë©ë‹ˆë‹¤. ë‹¤ìš´ë¡œë“œí•œ íŒŒì¼ì„ ê¼­ ì²¨ë¶€í•´ ì£¼ì„¸ìš”!");
    }
</script>
</body>
</html>